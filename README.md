# Развертывание инфраструктуры web-приложения, с использованием средств автоматизации
  
### Схема инфраструктуры веб-приложения
  
<img src="images/infrastructure_webapp.svg" alt="infrastructure_webapp" width=720>
  
### Описание инфрасруктуры
  
Инфраструктура приложения включает в себя:
- Реверс-прокси, на основе Nginx;
- 2-а сервера обрабатывающих запросы пользователей к приложению, на основе Nodejs;
- 2-а сервера баз данных, состоящих их кластера репликации Postgesql.
  
Так же в инфраструктуру включен сервер резервного копирования Barman, на немже организовано централизованное хранение логов.  
  
### Востановление работы приложения после кретических сбоев
  
  
Востановления проксирующего сервера nginx осуществляется командой ``` ansible-playbook ./ansible/playbook.yaml -i ./ansible/inventory -t nginx ```  
Для шифрования трафика используется самоподписанный сертификат и в случаии полной потери сервера nginx потребуется создание надежной группы Диффи-Хеллмана (DH), которая используется при согласовании совершенной прямой секретности с клиентами. Это выполняется командой ``` sudo openssl dhparam -out /etc/nginx/dhparam.pem 4096 ```. Это займет некоторое время, но по окончанию процесса мы получем группу DH в /etc/nginx/dhparam.pem, которая будет использоваться при конфигурации.

